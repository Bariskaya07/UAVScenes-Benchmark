# TokenFusion DELIVER Configuration
# RGB + LiDAR Multi-Modal Semantic Segmentation
# Cross-dataset evaluation settings

# ==============================================================================
# Dataset Configuration
# ==============================================================================
dataset:
  name: "DELIVER"
  data_path: "data/DELIVER"
  num_classes: 25
  ignore_label: 255

  # DELIVER 25 class names
  class_names:
    - "Building"
    - "Fence"
    - "Other"
    - "Pedestrian"
    - "Pole"
    - "RoadLine"
    - "Road"
    - "SideWalk"
    - "Vegetation"
    - "Cars"
    - "Wall"
    - "TrafficSign"
    - "Sky"
    - "Ground"
    - "Bridge"
    - "RailTrack"
    - "GroundRail"
    - "TrafficLight"
    - "Static"
    - "Dynamic"
    - "Water"
    - "Terrain"
    - "TwoWheeler"
    - "Bus"
    - "Truck"

# ==============================================================================
# Model Configuration
# ==============================================================================
model:
  backbone: "mit_b2"
  embedding_dim: 256
  # TokenFusion uses shared weights - both modalities need 3 channels
  in_chans: 3
  pretrained: "pretrained/mit_b2.pth"

# ==============================================================================
# Training Configuration
# ==============================================================================
training:
  image_size: 1024
  crop_size: 1024
  batch_size: 4
  num_workers: 8
  epochs: 60
  max_iter: 24000
  val_every: 5
  save_every: 10
  seed: 42
  amp: true

# ==============================================================================
# Optimizer Configuration
# ==============================================================================
optimizer:
  type: AdamW
  lr: 6.0e-5
  betas: [0.9, 0.999]
  weight_decay: 0.01

# ==============================================================================
# Scheduler Configuration
# ==============================================================================
scheduler:
  type: PolyLR
  max_epochs: 60
  power: 1.0
  warmup_type: linear
  warmup_epochs: 3
  warmup_ratio: 1.0e-6
  lr_mult: 10.0

# ==============================================================================
# Loss Configuration
# ==============================================================================
loss:
  lamda: 1.0e-3

# ==============================================================================
# TokenFusion Configuration
# ==============================================================================
tokenfusion:
  mask_threshold: 0.02
  num_parallel: 2

# ==============================================================================
# Data Augmentation
# ==============================================================================
augmentation:
  scale_range: [0.5, 2.0]
  crop_size: [1024, 1024]
  flip_prob: 0.5
  photometric:
    enable: true
    brightness: 0.2
    contrast: 0.2
    saturation: 0.2
    hue: 0.1
  gaussian_blur:
    enable: true
    prob: 0.5
    kernel_size: 5

# ==============================================================================
# LiDAR Configuration
# ==============================================================================
lidar:
  # Dataset aux channels (3 for TokenFusion shared weights)
  aux_channels: 3

# ==============================================================================
# Normalization
# ==============================================================================
normalization:
  rgb_mean: [0.485, 0.456, 0.406]
  rgb_std: [0.229, 0.224, 0.225]
  # LiDAR normalization (placeholder - update with actual DELIVER stats)
  lidar_mean: [0.5, 0.5, 0.5]
  lidar_std: [0.5, 0.5, 0.5]

# ==============================================================================
# Evaluation Configuration
# ==============================================================================
evaluation:
  mode: "slide"
  slide_size: 1024
  slide_stride: 512

# ==============================================================================
# Logging
# ==============================================================================
logging:
  log_dir: "logs"
  checkpoint_dir: "checkpoints"
  tensorboard: true
  print_freq: 20

# ==============================================================================
# Distributed Training
# ==============================================================================
distributed:
  enabled: false
  backend: "nccl"
